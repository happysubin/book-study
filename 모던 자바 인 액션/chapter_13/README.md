# chapter 13. 디폴트 메서드

* 자바 8에서는 기본 구현을 포함하는 인터페이스를 정의하는 두 가지 방법을 제공한다.
* 첫 번째는 인터베이스 내부에 static 메서드를 정의하는 것이다.
* 두 번째는 인터페이스의 기본 구현을 제공할 수 있도록 디폴트 메서드를 사용하는 것이다.
* 즉 메서드 구현을 포함하는 인터페이스를 정의할 수 있다.
* 위 두 가지 방법을 사용하면 인터페이스 설계가 변경되었을 때 인터페이스를 구현한 클래스들의 설계를 변경할 필요가 없다.
* 디폴트 메서드는 주로 라이브러리 설계자들이 사용한다. 
* 디폴트 메서드를 이용하면 자바 API의 호환성을 유지하면서 라이브러리를 바꿀 수 있기 때문이다.

## section 13.1 변화하는 API

* 인터페이스 초기버전을 수정하는 예제를 살펴봄.
* 인터페이스에 새로운 메서드를 추가하면 바이너리 호환성은 유지가 된다.
* 바이너리 호환성이란 새로 추가된 메서드를 호출하지만 않으면 새로운 메서드 구현이 없어도 기존 클래스 파일 구현이 잘 동작한다는 의미다.
* 언젠가 구현 클래스를 인수로 받는 클래스에서 새로 정의된 추상 메서드를 사용하도록 코드를 바꾸면 런타임 에러가 발생한다.
* 또한 전체 애플리케이션을 재빌드 할 때는 컴파일 에러가 발생할 것이다.
* 디폴트 메서드로 이 모든 문제를 해결할 수 있다.

## section 13.2 디폴트 메서드란 무엇인가?

* 자바 8에서는 호환성을 유지하면서 API를 바꿀 수 있도록 새로운 기능인 디폴트 메서드를 제공한다.
* 이제 인터페이스는 자신을 구현하는 클래스에서 메서드를 구현하지 않을 수 있는 새로운 메서드 시그니처를 제공한다.
* 인터페이스를 구현하는 클래스에서 구현하지 않은 메서드는 인터페이스 자체에서 기본으로 제공한다. 그래서 디폴트 메서드라고 부른다.
* 인터페이스에서 메서드 선언부 앞에 default라는 키워드를 붙이고 메서드 몸통을 작성하면 된다.
* 예시는 아래와 같다.

```
public interface Sized{
    default boolean isEmpty(){
        return size() == 0;
    }
}
```

## section 13.3 디폴트 메서드 활용 패턴

* 디폴트 메서드를 이용하는 방식, 선택형 메서드와 다중 상속에 대해 살펴보자.

### 선택형 메서드

* 선택형 메서드 예시로 Iterator 인터페이스의 remove 메서드 정의를 살펴보았다. remove 메서드가 디폴트 메서드다.
* 기본 구형이 제공되므로 Iterator 인터페이스를 구현하는 클래스는 빈 remove 메서드를 구현할 필요가 없어졌고, 불필요한 코드를 줄일 수 있다.

### 동작 다중 상속

* 자바에서 클래스는 한 개의 다른 클래스만 상속할 수 있지만, 인터페이스는 여러 개 구현할 수 있다.
* ArrayList의 경우를 살펴보았다. ArrayList는 한 개의 클래스를 상속하고, 여섯 개의 인터페이스를 구현한다.
* 자바 8에서는 인터페이스가 구현을 포함할 수 있으므로 클래스는 여러 인터페이스에서 동작(구현 코드)을 상속 받을 수 있다.
* 다양한 인터페이스가 가진 디폴트 메서드를 사용해 중복 코드를 줄이는 예제를 확인했다.

## section 13.4 해석 규칙

* 자바 8에는 디폴트 메서드가 추가되었으므로 같은 시그니처를 갖는 디폴트 메서드를 상속받는 상황이 생길 수 있다.
* 이런 상황에서는 어떤 인터페이스의 디폴트 메서드를 사용하게 될까?
* 다른 클래스나 인터페이스로부터 같은 시그니처를 갖는 메서드를 상속받을 때는 세 가지 규칙을 따라야 한다.
  1. 클래스가 항상 이긴다. 클래스나 슈퍼클래스에서 정의한 메서드가 디폴트 메서드보다 우선권을 갖는다.
  2. 1번 규칙 이외의 상황에서는 서브 인터페이스가 이긴다. 상속 관계를 갖는 인터페이스에서 같은 시그니처를 갖는 메서드를 정의할 때는 서브 인터페이스가 이긴다. 즉 B가 A를 상속받는다면 B가 A를 이긴다.
  3. 여전히 디폴트 메서드의 우선순위가 결정되지 않았다면 여러 인터페이스를 상속받는 클래스가 명시적으로 디폴트 메서드를 오버라이드하고 호출해야 한다.
* 디폴트 메서드 해석과 충돌에 관한 문제들을 살펴봄.


## section 13.5 정리

* 자바 8의 인터페이스는 구현 코드를 포함하는 디폴트 메서드, 정적 메서드를 정의할 수 있다.
* 디폴트 메서드의 정의는 default 키워드로 시작하며 일반 클래스 메서드처럼 바디를  갖는다.
* 공개된 인터페이스에 추상 메서드를 추가하면 소스 호환성이 깨진다.
* 디폴트 메서드 덕분에 라이브러리 설계자가 API를 바꿔도 기존 버전과 호환성을 유지할 수 있다.
* 선택형 메서드와 동작 상속에도 디폴트 메서드를 사용할 수 있다.
* 클래스가 같은 시그니처를 갖는 여러 디폴트 메서드를 상속하면서 생기는 충돌 문제를 해결하는 규칙이 있다.
* 클래스나 슈퍼 클래스에 정의된 메서드가 다른 디폴트 메서드 정의보다 우선한다. 이외의 상황에서는 서브인터페이스에서 제공하는 디폴트  메서드가 선택된다.
* 두 메서드의 시그니처가 같고, 상속관계로도 충돌 문제를 해결할 수 없을 때는 디폴트 메서드를 사용하는 클래스에서 메서드를 오버라이드해서 어떤 디폴트 메서드를 호출할지 명시적으로 결정해야 한다.