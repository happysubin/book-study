
# 인덱스 고려 없이 열을 사용하는 나쁜 SQL 문 

## 튜닝 전

```sql
SELECT 성, 성별, COUNT(1) AS 카운트
FROM 사원 GROUP BY 성, 성별              
```


```sql
explain SELECT 성, 성별, COUNT(1) AS 카운트
        FROM 사원 GROUP BY 성, 성별
```

* 우리가 생성해서 건 인덱스는 칼럼 순이 (성별, 성)이 었다. 위 쿼리는 결합 인덱스의 컬럼 순서를 전혀 고려하지 않음.
* 사원 테이블의 I_성별_성 인덱스를 활용하고, 임시 테이블을 생성해 성과 성별을 그루핑해 카운트 연산을 수행한다.
* 인덱스 순서를 활용하는 것이 중요하다.

## 튜닝 후

```sql
SELECT 성, 성별, COUNT(1) AS 카운트
FROM 사원 GROUP BY 성별, 성       
```


```sql
explain SELECT 성, 성별, COUNT(1) AS 카운트
        FROM 사원 GROUP BY 성별, 성   
```

* 이미 존재하는 I_성별_성 인덱스를 최대한 활용하려면 인덱스 순서대로 그루핑하면 된다.
* 그러면 별도의 임시 테이블을 생성하지 않고도 그루핑과 카운트 연산을 수행할 수 있다.