# chapter 4. 클래스와 인터페이스

## item 24. 맴버 클래스는 되도록 static으로 만들어라.

중첩 클래스는(nested class)란 다른 클래스 안에 정의된 클래스를 말한다.

* 중첩 클래스는 자신을 감싼 바깥 클래스에서만 쓰여야 하며, 그 외의 쓰임새가 있다면 톱레벨 클래스로 만들어야 한다.
* 중첩 클래스의 종류는 정적 멤버 클래스, 멤버 클래스, 익명 클래스, 지역 클래스 4개다.
* 첫 번째를 제외한 나머지는 모두 내부 클래스다.
* 정적 멤버 클래스는 흔히 바깥 클래스와 함께 쓰일 때만 유용한 public 도우미 클래스로 쓰인다.

정적 멤버 클래스와 비정적 멤버 클래스의 구문상 차이는 단지 static이 붙어 있고 없고 뿐이지만, 의미상 차이는 꽤 크다.

* 비정적 멤버 클래스의 인스턴스는 바깥 클래스의 인스턴스와 암묵적으로 연결된다.
* 그래서 비 정적 멤버 클래스의 인스턴스 메서드에서 정규화된 this를 사용해 바깥 인스턴스의 메서드를 호출하거나 바깥 인스턴스의 참조를 가져올 수 있다.
* 정규화된 this란 클래스명.this 형태로 바깥 클래스의 이름을 명시하는 용법을 말한다.
* 따라서 개념상 중첩 클래스의 인스터스가 바깥 인스턴스와 독립적으로 존재할 수 있다면 정적 멤버 클래스로 만들어야 한다.
* 비정적 멤버 클래스는 바깥 인스턴스 없이는 생성할 수 없기 때문이다.
* 비정적 멤버 클래스의 인스턴스와 바깥 인스턴스 사이의 관계는 멤버 클래스가 인스턴스화 될 때 확립되며, 더 이상 변경할 수 없다.
* 이 관계는 바깥 클래스가 인스턴스화할 때 확립되며, 변경 불가하다.
* 이 관계는 비정적 클래스의 인스턴스 안에 만들어져 메모리 공간을 차지하며, 생성 시간도 더 걸린다.
* 비정적 멤버 클래스는 어댑터를 정의할 때 자주 쓰인다.
* 즉, 어떤 클래스의 인스턴스를 감싸 마치 다른 클래스의 인스턴스처럼 보이게 하는 뷰로 사용하는 것이다. (Map의 keySet 등)

#### 멤버 클래스에서 바깥 인스턴스에 접근할 일이 없다면 무조건 static을 붙여서 정적 멤버 클래스로 만들자.

* static을 생략하면 바깥 인스턴스로의 숨은 외부 참조를 가진다. 즉 시간과 공간이 소비된다.
* 제일 큰 문제는 GC가 바깥 클래스의 인스턴스를 수거하지 못하는 메모리 누수가 생길 수 있다.

private 정적 멤버 클래스는 흔히 바깥 클래스가 표현하는 객체의 한 부분을 나타낼 때 쓴다.

* 예시는 Map.
* 많은 Map 구현체는 각각 키-값 쌍을 표현하는 엔트리 객체들을 가진다.
* 모든 엔트리가 맵과 연관되어 있지만 엔트리의 메서드들은 맵을 직접 사용하지는 않는다.
* 따라서 엔트리를 비정적 멤버 클래스로 표현하는 것은 낭비고, private 정적 멤버 클래스가 가장 알맞다.

멤버 클래스가 공개된 public이나 protected 멤버라면 정적이냐 아니냐는 두배로 중요하다.
멤버 클래스 역시 공개 API가 되니, 혹시라도 향후 릴리스에서 static을 붙이면 하위 호환성이 깨진다.


## 정리

* 중첩 클래스에는 네 가지가 있다. 쓰임은 각각 다르다.
* 메서드가 밖에서도 사용해야 하거나 메서드 안에 정의하기엔 너무 길다면 멤버 클래스로 만든다.
* 멤버 클래스의 인스턴스 각각이 바깥 인스턴스를 참조한다면 비정적으로, 그렇지 않으면 정적으로 만들자.
* 중첩 클래스가 한 메서드 안에서만 쓰이면서 그 인스턴스를 생성하는 지점이 단 한 곳이고 해당 타입으로 쓰기에 적합한 클래스나 인터페이스가 이미 있다면 익명 클래스로 만들자.
* 그렇지 않다며 지역 클래스를 사용하자.
