# Chapter 04.

이번 챕터부터는 문서 관리 시스템을 개발한다.

## Section 03. (문서 관리 시스템 요구사항)

문서 관리 시스템은 기존 환자 정보 파일을 읽어 색인을 추가하고 검색할 수 있는 형태의 정보로 변환해야 한다.

그녀는 다음과 같은 세 가지 형식의 문서를 다룬다.

* 리포트: 환자의 수술과 관련된 상담 내용을 기록한 본문이다.
* 우편물: 특정 주소로 발송되는 텍스트 문서다.
* 이미지: 치아와 잇몸 엑스레이 사진을 저장한다. 용량이 크다.

각각의 문서는 관리 대상 파일의 경로와 어떤 환자의 기록물인지를 나타내는 정보도 포함해야 한다.
아바즈 선생님은 문서를 쉽게 찾을 뿐만 아니라 다양한 종류의 문서에서 특정 정보를 포함하는 문서를 검색해 찾기를 원한다.

예를 들어 본문에 'Joe Bloggs'를 포함하는 우편물 문서를 검색하면 그 결과를 반환해야 한다.

<br>

## Section 04. (설계 작업)

문서 관리 시스템은 필요에 따라 문서를 임포트해 내부 문서 저장소에 추가한다.

두 메서드를 포함하는 Document ManagementSystem 클래스를 만들어 이 요구사항을 구현한다.

* void importFile(String path) : 사용자가 문서 관리 시스템으로 임포트하려는 파일의 경로를 받는다.
* List<Document> contents() : 문서 관리 시스템에 저장된 모든 문서를 반환

공개 api는 문자열을 사용하지만  Importer 인터페이스는 File 객체를 사용해 임포트하는 파일을 가리킨다.

### Document 구현

Document 구현은 HashMap을 상속하는 것보다 HashMap을 인스턴스 변수로 가져 조합하는 방식이 더 좋다. 

> 도메인 클래스를 사용하면 개념에 이름을 붙이고 수행할 수 있는 동작과 값을 제한하므로 발견성을 개선하고 버그 발생 범위를 줄일 수 있다.

> is-a 관계에서는 상속 관계를 선택하는 것이 적절하지만, 다른 경우에는 대부분 조합(인터페이스)가 더 좋다.

<br>

### Section 07. (기존 코드 확장과 재사용)

텍스트 문서가 여러개 생겨버림. 이를 위한 해결법으로 3가지가 제시됨.

1. 유틸 클래스 적용 -> 이건 후에 갓 클래스가 될 확률이 있어서 X
2. 상속 사용. 텍스트 임포터를 상속한 서브 클래스로 문제를 해결하자.
3. 도메인 클래스 도입. 새로운 도메인 클래스를 도입해 문제를 해결.

상속과 도메인 클래스 도입 중에 고민이 된다. 그러나 완벽한 is-a 관계가 아니면 보통 상속은 좋지 않다.

시간이 흐르고 응용프로그램이 바뀔 때, 응용프로그램을 그에 맞게 바꾸는 것보다는 변화를 추상화하는 것이 더 좋다.

일반적으로 상속 관계로 코드를 재사용하는 것은 좋은 방법이 아니다.

__결국 도메인 클래스로 텍스트 문서를 모델링하는 방법을 적용__

<br>

### Section 08. (테스트 위생)

* 테스트는 공개 동작만 테스트한다. 예전에 큰 비즈니스 로직(동작)을 테스트한다는 논리와 비슷
* 세부 구현에 의한 테스트는 구현이 바뀌면 결과가 실패로 바뀐다. 즉 세부 구현에 테스트가 의존하면 안된다.